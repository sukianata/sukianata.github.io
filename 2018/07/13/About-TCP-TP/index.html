<!DOCTYPE html>












  


<html class="theme-next muse use-motion" lang="en">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2"/>
<meta name="theme-color" content="#222">












<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />






















<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=6.3.0" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=6.3.0">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=6.3.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=6.3.0">


  <link rel="mask-icon" href="/images/logo.svg?v=6.3.0" color="#222">









<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '6.3.0',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":true,"onmobile":false},
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="網上學習資料整理">
<meta name="keywords" content="TCP&#x2F;IP">
<meta property="og:type" content="article">
<meta property="og:title" content="About TCP&#x2F;TP">
<meta property="og:url" content="http://sukianata.coding.me/2018/07/13/About-TCP-TP/index.html">
<meta property="og:site_name" content="清露晨流，新桐初引">
<meta property="og:description" content="網上學習資料整理">
<meta property="og:locale" content="en">
<meta property="og:image" content="https://coding.net/u/sukianata/p/ImgRepository/git/raw/master/TCP%26IP/201807130221.png">
<meta property="og:image" content="https://coding.net/u/sukianata/p/ImgRepository/git/raw/master/TCP%26IP/20180713.png">
<meta property="og:image" content="https://coding.net/u/sukianata/p/ImgRepository/git/raw/master/TCP%26IP/201807130243.png">
<meta property="og:image" content="https://coding.net/u/sukianata/p/ImgRepository/git/raw/master/TCP%26IP/2018.7130249.png">
<meta property="og:image" content="https://coding.net/u/sukianata/p/ImgRepository/git/raw/master/TCP%26IP/201807130308.png">
<meta property="og:image" content="https://coding.net/u/sukianata/p/ImgRepository/git/raw/master/TCP%26IP/201807130311.png">
<meta property="og:image" content="https://coding.net/u/sukianata/p/ImgRepository/git/raw/master/TCP%26IP/201807130320.png">
<meta property="og:image" content="https://coding.net/u/sukianata/p/ImgRepository/git/raw/master/TCP%26IP/201807130324.png">
<meta property="og:image" content="https://coding.net/u/sukianata/p/ImgRepository/git/raw/master/TCP%26IP/201807130438.png">
<meta property="og:image" content="https://coding.net/u/sukianata/p/ImgRepository/git/raw/master/TCP%26IP/201807130439.png">
<meta property="og:image" content="https://coding.net/u/sukianata/p/ImgRepository/git/raw/master/TCP%26IP/201807130517.png">
<meta property="og:image" content="https://coding.net/u/sukianata/p/ImgRepository/git/raw/master/TCP%26IP/201807130519.png">
<meta property="og:image" content="https://coding.net/u/sukianata/p/ImgRepository/git/raw/master/TCP%26IP/201807160830.png">
<meta property="og:image" content="https://coding.net/u/sukianata/p/ImgRepository/git/raw/master/TCP%26IP/201807060833.png">
<meta property="og:image" content="https://coding.net/u/sukianata/p/ImgRepository/git/raw/master/TCP%26IP/201807160834.png">
<meta property="og:image" content="https://coding.net/u/sukianata/p/ImgRepository/git/raw/master/TCP%26IP/201807160848.png">
<meta property="og:image" content="https://coding.net/u/sukianata/p/ImgRepository/git/raw/master/TCP%26IP/201807160858.png">
<meta property="og:image" content="https://coding.net/u/sukianata/p/ImgRepository/git/raw/master/TCP%26IP/201807160901.png">
<meta property="og:image" content="https://coding.net/u/sukianata/p/ImgRepository/git/raw/master/TCP%26IP/201807160903.png">
<meta property="og:image" content="https://coding.net/u/sukianata/p/ImgRepository/git/raw/master/TCP%26IP/201807160914.png">
<meta property="og:image" content="https://coding.net/u/sukianata/p/ImgRepository/git/raw/master/TCP%26IP/201807160917.png">
<meta property="og:updated_time" content="2018-07-16T01:35:25.337Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="About TCP&#x2F;TP">
<meta name="twitter:description" content="網上學習資料整理">
<meta name="twitter:image" content="https://coding.net/u/sukianata/p/ImgRepository/git/raw/master/TCP%26IP/201807130221.png">






  <link rel="canonical" href="http://sukianata.coding.me/2018/07/13/About-TCP-TP/"/>



<script type="text/javascript" id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>About TCP/TP | 清露晨流，新桐初引</title>
  









  <noscript>
  <style type="text/css">
    .use-motion .motion-element,
    .use-motion .brand,
    .use-motion .menu-item,
    .sidebar-inner,
    .use-motion .post-block,
    .use-motion .pagination,
    .use-motion .comments,
    .use-motion .post-header,
    .use-motion .post-body,
    .use-motion .collection-title { opacity: initial; }

    .use-motion .logo,
    .use-motion .site-title,
    .use-motion .site-subtitle {
      opacity: initial;
      top: initial;
    }

    .use-motion {
      .logo-line-before i { left: initial; }
      .logo-line-after i { right: initial; }
    }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">清露晨流，新桐初引</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
      
        <h1 class="site-subtitle" itemprop="description">boring,boring,boring</h1>
      
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="Toggle navigation bar">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">
    <a href="/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-home"></i> <br />Home</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-about">
    <a href="/about/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-user"></i> <br />About</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">
    <a href="/tags/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-/tags/"></i> <br />Tags</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">
    <a href="/archives/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />Archives</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-commonweal">
    <a href="/404/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-heartbeat"></i> <br />Commonweal 404</a>
  </li>

      
      
    </ul>
  

  
    

  

  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  
    <div class="reading-progress-bar"></div>
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://sukianata.coding.me/2018/07/13/About-TCP-TP/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="HuangFan">
      <meta itemprop="description" content="Java">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="清露晨流，新桐初引">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">About TCP/TP
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2018/07/13 16:46:33" itemprop="dateCreated datePublished" datetime="2018-07-13T16:46:33+08:00">2018/07/13</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2018/07/16 09:35:25" itemprop="dateModified" datetime="2018-07-16T09:35:25+08:00">2018/07/16</time>
              
            
          </span>

          

          
            
          

          
          

          
            <span class="post-meta-divider">|</span>
            <span class="post-meta-item-icon"
            >
            <i class="fa fa-eye"></i>
             Views:  
            <span class="busuanzi-value" id="busuanzi_value_page_pv" ></span>
            </span>
          

          

          
              <div class="post-description">網上學習資料整理</div>
          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h2 id="TCP-IP簡介"><a href="#TCP-IP簡介" class="headerlink" title="TCP/IP簡介"></a>TCP/IP簡介</h2><h3 id="OSI七層模型"><a href="#OSI七層模型" class="headerlink" title="OSI七層模型"></a>OSI七層模型</h3><p><img src="https://coding.net/u/sukianata/p/ImgRepository/git/raw/master/TCP%26IP/201807130221.png" alt=""> </p>
<ol start="2">
<li><p>ip用來從網絡中找到某一個電腦，端口用來找到某一個程序，一個ip的端口可以有65536個。  </p>
</li>
<li><p>常用協議端口號：</p>
<pre>
SSH 22
FTP 20 和 21
Telnet 23
SMTP 25
TFTP 69
HTTP 80
SNMP 161
Ping 使用ICMP，无具体端口号
</pre>  

</li>
</ol>
<h3 id="封裝和分用"><a href="#封裝和分用" class="headerlink" title="封裝和分用"></a>封裝和分用</h3><p><strong>封装</strong>：当应用程序发送数据的时候，数据在协议层次当中从顶向下通过每一层，每一层都会对数据增加一些首部或尾部信息，这样的信息称之为协议数据单元（Protocol Data Unit，缩写为PDU），在分层协议系统里，在指定的协议层上传送的数据单元，包含了该层的协议控制信息和用户信息。如下图所示：   </p>
<ul>
<li>物理层（一层）PDU指数据位（Bit）  </li>
<li>数据链路层（二层）PDU指数据帧（Frame）  </li>
<li>网络层（三层）PDU指数据包（Packet）  </li>
<li>传输层（四层）PDU指数据段（Segment）  </li>
<li>第五层以上为数据（data）<br><img src="https://coding.net/u/sukianata/p/ImgRepository/git/raw/master/TCP%26IP/20180713.png" alt="">   </li>
</ul>
<p><strong>分用</strong>：当主机收到一个数据帧时，数据就从协议层底向上升，通过每一层时，检查并去掉对应层次的报文首部或尾部，与封装过程正好相反。  </p>
<h2 id="鏈路層介紹"><a href="#鏈路層介紹" class="headerlink" title="鏈路層介紹"></a>鏈路層介紹</h2><h3 id="簡介"><a href="#簡介" class="headerlink" title="簡介"></a>簡介</h3><p>网络层协议的数据单元是 IP 数据报 ，而数据链路层的工作就是把网络层交下来的 IP 数据报 封装为 帧（frame）发送到链路上，以及把接收到的帧中的数据取出并上交给网络层。 为达到这一目的，数据链路必须具备一系列相应的功能，主要有：</p>
<p>将数据封装为帧（frame），帧是数据链路层的传送单位；</p>
<p>控制帧的传输，包括处理传输差错，调节发送速率与接收方相匹配；</p>
<p>在两个网络实体之间提供数据链路通路的建立、维持和释放的管理。</p>
<p>数据帧的结构是这样的：<br><img src="https://coding.net/u/sukianata/p/ImgRepository/git/raw/master/TCP%26IP/201807130243.png" alt="">  </p>
<h3 id="控制幀的傳輸"><a href="#控制幀的傳輸" class="headerlink" title="控制幀的傳輸"></a>控制幀的傳輸</h3><h4 id="差錯控制"><a href="#差錯控制" class="headerlink" title="差錯控制"></a>差錯控制</h4><p>通信系统必须具备发现差错的能力，并采取措施纠正之，使差错控制在所能允许的尽可能小的范围内，这就是差错控制过程，也是数据链路层的主要功能之一。</p>
<p><strong>反馈重发</strong></p>
<p>接收方通过对差错编码(奇偶校验码或 CRC 码)的检查，可以判定一帧在传输过程中是否发生了差错。一旦发现差错，一般可以采用反馈重发的方法来纠正。这就要求接受方收完一帧后，向发送方反馈一个接收是否正确的信息，使发送方据此做出是否需要重新发送的决定。发送方仅当收到接收方已正确接收的反馈信号后才能认为该帧已经正确发送完毕，否则需要重发直至正确为止。 </p>
<p><strong>计时器</strong></p>
<p>如果某一帧发送出现问题，一直不能发送成功，为了避免传输过程停滞不前，通常引入 计时器 (Timer) 来限定接收方发回反馈消息的时间间隔。当发送方发送一帧的同时也启动计时器，若在限定时间间隔内未能收到接收方的反馈信息，即计时器超时(Timeout)，则可认为传出的帧以出错或丢失，就要重新发送。</p>
<p><strong>序号</strong></p>
<p>由于同一帧数据可能被重复发送多次，就可能引起接收方多次收到同一帧并将其递交给网络层的情况。为了防止这种情况，可以采用对发送的帧编号的方法，即赋予每帧一个序号，从而使接收方能从该序号来区分是新发送来的帧还是重发的帧，以此来确定要不要将接收到的帧递交给网络层。  </p>
<h4 id="流量控制"><a href="#流量控制" class="headerlink" title="流量控制"></a>流量控制</h4><p>由于收发双方各自使用的设备工作速率和缓冲存储空间的差异，可能出现发送方的发送能力大于接收方接收能力的现象，此时若不对发送方的发送速率做适当的限制，前面来不及接收的帧将被后面不断发送来的帧“淹没”，从而造成帧的丢失而出错。</p>
<p>由此可见，流量控制实际上是对发送方数据流量的控制，使其发送速率不超过接收方的速率。所以需要一些规则使得发送方知道在什么情况下可以接着发送下一帧，而在什么情况下必须暂停发送，以等待收到某种反馈信息后再继续发送。这就是流量控制。  </p>
<h3 id="以太網"><a href="#以太網" class="headerlink" title="以太網"></a>以太網</h3><p>以太网(Ether-net)是指 DEC 公司、Intel 公司和 Xerox 公司在 1982 年联合公布的一个标准，这个标准里面使用了一种称作 CSMA/CD 的接入方法。而 IEEE802 提供的标准集 802.3(还有一部分定义到了 802.2 中)也提供了一个 CSMA/CD 的标准。</p>
<p>这两个标准稍有不同，因此链路层数据帧的的封装格式也有所不同（数据帧中的地址为 MAC 地址）：<br><img src="https://coding.net/u/sukianata/p/ImgRepository/git/raw/master/TCP%26IP/2018.7130249.png" alt="">  </p>
<h3 id="PPP-點對點協議"><a href="#PPP-點對點協議" class="headerlink" title="PPP(點對點協議)"></a>PPP(點對點協議)</h3><p>PPP（点到点协议）是为在同等单元之间传输数据设计的链路层协议。这种链路提供全双工操作，并按照顺序传递数据。设计目的主要是用来通过 拨号或专线 方式建立 点对点 连接发送数据，使其成为各种主机、网桥和路由器之间简单连接的一种共通的解决方案。</p>
<p>点对点协议（PPP）为在点对点连接上传输多协议数据包提供了一个标准方法。PPP 最初设计是为两个对等节点之间的 IP 流量传输提供一种封装协议。在 TCP/IP 协议集中它是一种用来同步调制连接的数据链路层协议。  </p>
<h2 id="IP網際協議"><a href="#IP網際協議" class="headerlink" title="IP網際協議"></a>IP網際協議</h2><h3 id="IP數據報"><a href="#IP數據報" class="headerlink" title="IP數據報"></a>IP數據報</h3><p>IP 协议位于网络层，它是 TCP/IP 协议族中最为核心的协议，所有的 TCP、UDP、ICMP 及 IGMP 数据都以 IP 数据报格式传输。IP 协议提供的是 不可靠 、 无连接 的数据报传送服务。</p>
<p><strong>不可靠（unreliable）</strong>：IP 协议不能保证数据报能成功地到达目的地，它仅提供传输服务。当发生某种错误时，IP 协议会丢弃该数据报。传输的可靠性全由上层协议来提供。</p>
<p><strong>无连接（connectionless）</strong>：IP 协议对每个数据报的处理是相互独立的。这也说明， IP 数据报可以不按发送顺序接收。如果发送方向接收方发送了两个连续的数据报（先是 A，然后是 B），每个数据报可以选择不同的路线，因此 B 可能在 A 到达之前先到达。</p>
<p>首先看一下 IP 数据报的格式，其中没有一个字段是多余的，学习 IP 协议就应从学习它的报文字段意义和作用开始。<br><img src="https://coding.net/u/sukianata/p/ImgRepository/git/raw/master/TCP%26IP/201807130308.png" alt=""><br> 如上图所示，普通的 IP 数据报的报头长度 20 字节(除非有选项字段)，各个部分的作用：</p>
<ul>
<li><p><strong>版本号</strong> ：4 位，用于标明 IP 版本号，0100 表示 IPv4，0110 表示 IPv6。目前常见的是 IPv4。</p>
</li>
<li><p><strong>首部长度</strong> ：4 位，表示 IP 报头长度，包括选项字段。</p>
</li>
<li><p><strong>服务类型(TOS)</strong> ：分别有：最小时延、最大吞吐量、最高可靠性、最小花费 4 种服务，如下图所示。4 个标识位只能有一个被置为 1 ：<br><img src="https://coding.net/u/sukianata/p/ImgRepository/git/raw/master/TCP%26IP/201807130311.png" alt="">  </p>
</li>
<li><p><strong>总长度</strong> ：16 位，报头长度加上数据部分长度，便是数据报的总长度。IP 数据报最长可达 65535 字节。</p>
</li>
<li><p><strong>标识</strong> ：16 位，接收方根据分片中的标识字段相不相同来判断这些分片是不是同一个数据报的分片，从而进行分片的重组。通常每发送一份报文它的值就会加 1。</p>
</li>
<li><p><strong>标志</strong> ：3 位，用于标识数据报是否分片。其中的第 2 位是不分段（DF）位。当 DF 位被设置为 1 时，则不对数据报进行分段处理；第 3 位是分段（MF）位，除了最后一个分段的 MF 位被设置为 0 外，其他的分段的 MF 位均设置为 1。</p>
</li>
<li><p><strong>偏移</strong> ：13 位，在接收方进行数据报重组时用来标识分片的顺序。</p>
</li>
<li><p><strong>生存时间(TTL)</strong> ：8 位，用于设置数据报可以经过的最多的路由器个数。TTL 的初始值由源主机设置（通常为 32 或 64），每经过一个处理它的路由器，TTL 值减 1。如果一个数据报的 TTL 值被减至 0，它将被丢弃。</p>
</li>
<li><p><strong>协议</strong> ：8 位，用来标识是哪个协议向 IP 传送数据。ICMP 为 1，IGMP 为 2，TCP 为 6，UDP 为 17，GRE 为 47，ESP 为 50。</p>
</li>
<li><p><strong>首部校验和</strong> ：根据 IP 首部计算的校验和码。</p>
</li>
<li><p><strong>源 IP 和目的 IP</strong> ：数据报头还会包含该数据报的发送方 IP 和接收方 IP。</p>
</li>
<li><p><strong>选项</strong> ：是数据报中的一个可变长、可选的信息，不常用，多用于安全、军事等领域    </p>
</li>
</ul>
<h3 id="IP地址分類"><a href="#IP地址分類" class="headerlink" title="IP地址分類"></a>IP地址分類</h3><p>为了便于寻址以及层次化构造网络，每个 IP 地址可被看作是分为两部分，即 网络号 和 主机号 。同一个区域的所有主机有相同的网络号(即 IP 地址的前半部分相同)，区域内的每个主机（包括路由器）都有一个主机号与其对应。</p>
<p>IP 地址被分为 A,B,C,D,E 五类，其中 A 类给大型网络或政府机构等，B 类分配给中型网络、跨国企业等，C 类分配给小型网络，D 类用于多播，E 类用于实验，各类可容纳的地址数目不同。其中我们最常见的为 A,B,C 这三类。</p>
<p>IP 地址用 32 位二进制数字表示的时候，A,B,C 类 IP 的网络号长度分别为 8 位、16 位、24 位：<br><strong>A 类地址</strong></p>
<p>A 类地址网络号范围：1.0.0.0—127.0.0.0</p>
<p>A 类 IP 地址范围：1.0.0.0—127.255.255.255</p>
<p>A 类 IP 的私有地址范围：10.0.0.0—10.255.255.255 （所谓的私有地址就是在互联网上不使用，而被用在局域网络中的地址）</p>
<p>127.X.X.X 是保留地址，用做循环测试用的</p>
<p>因为主机号有 24 位，所以一个 A 类网络号可以容纳 2^24-2=16777214 个主机号</p>
<p><strong>B 类地址</strong></p>
<p>B 类地址网络号范围：128.0.0.0—191.255.0.0</p>
<p>B 类 IP 地址范围：128.0.0.0—191.255.255.255</p>
<p>B 类 IP 的私有地址范围：172.16.0.0—172.31.255.255</p>
<p>169.254.X.X 是保留地址；191.255.255.255 是广播地址</p>
<p>因为主机号有 16 位，所以一个 B 类网络号可以容纳 2^16-2=65534 个主机号</p>
<p><strong>C 类地址</strong></p>
<p>C 类地址网络号范围：192.0.0.0—223.255.255.0</p>
<p>C 类 IP 地址范围：192.0.0.0—223.255.255.255</p>
<p>C 类 IP 的私有地址范围：192.168.0.0—192.168.255.255</p>
<p>因为主机号有 8 位，所以一个 C 类网络号可以容纳 2^8-2=254 个主机号<br> <img src="https://coding.net/u/sukianata/p/ImgRepository/git/raw/master/TCP%26IP/201807130320.png" alt="">  </p>
<h3 id="子網劃分"><a href="#子網劃分" class="headerlink" title="子網劃分"></a>子網劃分</h3><p>IP 地址如果只使用 ABCDE 类来划分，会造成大量的浪费：一个有 500 台主机的网络，无法使用 C 类地址。但如果使用一个 B 类地址，6 万多个主机地址只有 500 个被使用，造成 IP 地址的大量浪费。</p>
<p>因此，可以在 ABC 类网络的基础上，进一步划分子网：占用主机号的前几个位，用于表示子网号 。</p>
<p>这样 IP 地址就可看作 IP = 网络号 + 子网号 + 主机号</p>
<p>子网号的位数没有硬性规定，于是我们用 子网掩码 来确定一个 IP 地址中哪几位是主机号，具体使用方法如图：<br><img src="https://coding.net/u/sukianata/p/ImgRepository/git/raw/master/TCP%26IP/201807130324.png" alt=""><br>子网掩码中的 1 标识了 IP 地址中相应的网络号，0 标识了主机号。将 IP 地址和子网掩码进行 逻辑与运算 ，结果就能区分网络号和子网号。  </p>
<h3 id="IP路由選擇"><a href="#IP路由選擇" class="headerlink" title="IP路由選擇"></a>IP路由選擇</h3><p>如果发送方与接收方直接相连（点对点）或都在一个共享网络上（以太网），那么 IP 数据报就能直接送达。 而大多数情况则是发送方与接收方通过若干个路由器(router)连接，那么数据报就需要经过若干个路由器的转发才能送达，它是怎么选择一个合适的路径来”送货”的呢？</p>
<p>IP 层在内存中有一个路由表（输入命令 route -n 可以查看路由表），当收到一份数据报并进行发送时，都要对该表进行搜索：</p>
<p>1、搜索路由表，如果能找到和目的 IP 地址完全一致的主机，则将 IP 数据报发向该主机；</p>
<p>2、搜索路由表，如果匹配主机失败，则匹配同子网的路由器(这需要子网掩码的协助)。如果找到路由器，则将 IP 该数据报发向该路由器；</p>
<p>3、搜索路由表，如果匹配同子网路由器失败，则匹配同网络号路由器，如果找到路由器，则将该 IP 数据报发向该路由器；</p>
<p>4、如果以上都失败了，就搜索默认路由，如果默认路由存在，则发报；</p>
<p>6、如果都失败了，就丢掉这个包；</p>
<p>7、接收到数据报的路由器再按照它自己的路由表继续转发，直到数据报被转发到目的主机；</p>
<p>8、如果在转发过程中，IP 数据报的 TTL（生命周期）已经被减为 0，则该 IP 数据报就被抛弃。  </p>
<h3 id="NAT技術"><a href="#NAT技術" class="headerlink" title="NAT技術"></a>NAT技術</h3><p>当你用 ifconfig 查看 IP 地址时，有时你会发现自己的 IP 地址是这样的———192.168.X.X 或 172.16.X.X<br>这是 C 类网和 B 类网的私有地址，这就是俗称的内网 IP。这是因为你的路由器采用了 NAT 技术。</p>
<p>NAT（Network Address Translation，网络地址转换）是 1994 年提出的。当在专用网内部的一些主机本来已经分配到了内网 IP 地址，但现在又想和因特网上的主机通信时，NAT 技术将其内网 IP 地址转换成全球 IP 地址，然后与因特网连接，也就是说，内网的数台主机使用了同一个全球 IP 地址在上网。</p>
<p>NAT 技术实现了宽带共享，而且有助于缓解 IP 地址空间枯竭的问题。  </p>
<h3 id="IP的未來"><a href="#IP的未來" class="headerlink" title="IP的未來"></a>IP的未來</h3><p>我们现在使用的 IPv4 协议版本从理论上讲，可以编址 1600 万个网络、40 亿台主机。但采用 A、B、C 三类编址方式后，可用的网络地址和主机地址的数目大打折扣，以至 IP 地址 已于 2011 年 2 月 3 日分配完毕 。 其中北美占有 3/4，约 30 亿个，而人口最多的亚洲只有不到 4 亿个，中国截止 2010 年 6 月 IPv4 地址数量达到 2.5 亿，落后于 4.2 亿网民的需求。地址不足，严重地制约了中国及其他国家互联网的应用和发展。</p>
<p>随着网络技术的发展，计算机网络将进入人们的日常生活，可能身边的每一样东西都需要连入全球因特网，在这样的环境下，IPv6 应运而生。</p>
<p>IPv6 的地址长度是 128 位，通常将这 128 位的地址按每 16 位划分为一个段，将每个段转换成十六进制数字，并用冒号隔开，比如：2000:0000:0000:0000:0001:2345:6789:abcd 就是一个 IPv6 地址。</p>
<p>单从数量级上来说，IPv6 所拥有的地址容量是 IPv4 的约 8×10^28 倍，达到 2^128（算上全零的）个。这不但解决了网络地址资源数量的问题，同时也为除电脑外的设备连入互联网在数量限制上扫清了障碍。</p>
<p>随着 IPv4 不足，支持 IPv6 的网络迅速增长，现在全球已经有 5%的网络使用 IPv6  </p>
<h2 id="網絡層其它協議"><a href="#網絡層其它協議" class="headerlink" title="網絡層其它協議"></a>網絡層其它協議</h2><p><strong>RAP協議</strong>：地址解析協議，通過目標地址的ip查詢目標主機的MAC地址<br><strong>RARP協議</strong>：逆向地址解析協議，用於將MAC地址轉換為IP地址<br><strong>ICMP</strong>:控制報文協議，反饋通信過程中的各種問題，ICMP 报文由 8 位错误类型、8 位条件代码和 16 位校验和组成，被封装在一个 IP 数据报中。<br>ping 程序和 traceroute 程序是两个常见的 基于 ICMP 协议 的工具。traceroute 程序是用来侦测主机到目的主机之间所经路由情况的重要工具。</p>
<h2 id="傳輸層：UDP協議"><a href="#傳輸層：UDP協議" class="headerlink" title="傳輸層：UDP協議"></a>傳輸層：UDP協議</h2><h3 id="傳輸層協議"><a href="#傳輸層協議" class="headerlink" title="傳輸層協議"></a>傳輸層協議</h3><p>从之前介绍的网络层协议来看，通信的两端是两台主机，IP 数据报首部就标明了这两台主机的 IP 地址。但是从传输层来看，是发送方主机中的一个进程与接收方主机中的一个进程在交换数据，因此，严格地讲，通信双方不是主机，而是主机中的进程。</p>
<p>主机中常常有多个应用进程同时在与外部通信(比如你的浏览器和 QQ 在同时运行)，下图中，A 主机的 AP1 进程在与 B 主机的 AP3 进程通信，同时主机 A 的 AP2 进程也在与 B 主机的 AP4 进程通信。</p>
<p>两个主机的传输层之间有一个灰色双向箭头，写着“传输层提供应用进程间的逻辑通信”。 逻辑通信：看起来是数据似乎是沿着双向箭头在传输层水平传输的，但实际上是沿图中的虚线经多个协议层次而传输。  </p>
<p><img src="https://coding.net/u/sukianata/p/ImgRepository/git/raw/master/TCP%26IP/201807130438.png" alt="">  </p>
<p>TCP/IP 协议栈传输层有两个重要协议——UDP 和 TCP，不同的应用进程在传输层使用 TCP 或 UDP 之一：<br><img src="https://coding.net/u/sukianata/p/ImgRepository/git/raw/master/TCP%26IP/201807130439.png" alt="">   </p>
<h3 id="端口"><a href="#端口" class="headerlink" title="端口"></a>端口</h3><p>在第一节我们已经了解过端口的概念，端口的作用体现在传输层。</p>
<p>刚才的图中，AP1 与 AP3 的通信与 AP2 与 AP4 的通信可以使用同一个传输层协议来传输(TCP 或 UDP)，根据 IP 地址或 MAC 地址都只能是把数据传到正确的主机，但具体需要传到哪一个进程，是通过端口来辨认的。比如同时使用浏览器和 QQ，浏览器占用 80 端口，而 QQ 占用 4000 端口，那么发送过来的 QQ 消息便会通过 4000 端口显示在 QQ 客户端，而不会错误地显示在浏览器上。</p>
<p>端口号有 0～65535 的编号，其中：</p>
<p>编号 0～1023 为 系统端口号 ，这些端口号可以在网址 <a href="http://www.iana.org" target="_blank" rel="noopener">www.iana.org</a> 查询到，它们被指派给了 TCP/IP 最重要的一些应用程序。 </p>
<ul>
<li><p>编号 1024～49151 为 登记端口号 ，为没有系统端口号的应用程序使用，使用这类端口号必须在 IANA 按规定手续登记，以防止重复。</p>
</li>
<li><p>编号 49152～65535 为 短暂端口号 ，是留给客户进程选择暂时使用的，使用结束后，这类端口号会被放开以供其它程序使用。  </p>
</li>
</ul>
<h3 id="UDP概述"><a href="#UDP概述" class="headerlink" title="UDP概述"></a>UDP概述</h3><p>UDP(User Datagram Protocol)用户数据报协议，它只在 IP 数据报服务之上增加了很少一点功能，它的主要特点有：</p>
<p>(1).UDP 是无连接的，发送数据之前不需要建立连接(而 TCP 需要)，减少了开销和时延。</p>
<p>(2).UDP尽最大努力交付，不保证交付可靠性。</p>
<p>(3).UDP 是面向报文的，对于从网络层交付下来的 IP 数据报，只做很简单的封装(8 字节 UDP 报头)，首部开销小。</p>
<p>(4).UDP 没有拥塞控制，出现网络拥塞时发送方也不会降低发送速率。这种特性对某些实时应用是很重要的，比如 IP 电话，视频会议等，它们允许拥塞时丢失一些数据，因为如果不抛弃这些数据，极可能造成时延的累积。</p>
<p>(5).UDP 支持一对一、一对多、多对一和多对多的交互通信。</p>
<p>从应用层到传输层，再到网络层的各层次封装：<br><img src="https://coding.net/u/sukianata/p/ImgRepository/git/raw/master/TCP%26IP/201807130517.png" alt="">  </p>
<h3 id="UDP報文"><a href="#UDP報文" class="headerlink" title="UDP報文"></a>UDP報文</h3><p>UDP 数据报可分为两部分：UDP 报头和数据部分。其中数据部分是应用层交付下来的数据。UDP 报头总共 8 字节，而这 8 字节又分为 4 个字段：<br><img src="https://coding.net/u/sukianata/p/ImgRepository/git/raw/master/TCP%26IP/201807130519.png" alt=""><br>(1)源端口 2 字节 在对方需要回信时可用，不需要时可以全 0；</p>
<p>(2)目的端口 2 字节 必须，也是最重要的字段；</p>
<p>(3)长度 2 字节 长度值包括报头和数据部分；</p>
<p>(4)校验和 2 字节 用于检验 UDP 数据报在传输过程中是否有出错，有错就丢弃。    </p>
<h2 id="傳輸層：TCP協議"><a href="#傳輸層：TCP協議" class="headerlink" title="傳輸層：TCP協議"></a>傳輸層：TCP協議</h2><h3 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h3><p>TCP 和 UDP 处在同一层——传输层，但是它们有很多的不同。TCP 是 TCP/IP 系列协议中最复杂的部分，它具有以下特点：</p>
<p>(1) TCP 提供 可靠的 数据传输服务，TCP 是 面向连接的 。应用程序在使用 TCP 通信之前，先要建立连接，这是一个类似“打电话”的过程，通信结束后还要“挂电话”。</p>
<p>(2) TCP 连接是 点对点 的，一条 TCP 连接只能连接两个端点。</p>
<p>(3) TCP 提供可靠传输，无差错、不丢失、不重复、按顺序。</p>
<p>(4) TCP 提供 全双工 通信，允许通信双方任何时候都能发送数据，因为 TCP 连接的两端都设有发送缓存和接收缓存。</p>
<p>(5) TCP 面向 字节流 。TCP 并不知道所传输的数据的含义，仅把数据看作一连串的字节序列，它也不保证接收方收到的数据块和发送方发出的数据块具有大小对应关系。</p>
<p><img src="https://coding.net/u/sukianata/p/ImgRepository/git/raw/master/TCP%26IP/201807160830.png" alt="">   </p>
<h3 id="TCP報文字段結構"><a href="#TCP報文字段結構" class="headerlink" title="TCP報文字段結構"></a>TCP報文字段結構</h3><p>TCP 是面向字节流的，而 TCP 传输数据的单元是 报文段 。一个 TCP 报文段可分为两部分：报头和数据部分。数据部分是上层应用交付的数据，而报头则是 TCP 功能的关键。</p>
<p>TCP 报文段的报头有前 20 字节的固定部分，后面 4n 字节是根据需要而添加的字段。如图则是 TCP 报文段结构：</p>
<p><img src="https://coding.net/u/sukianata/p/ImgRepository/git/raw/master/TCP%26IP/201807060833.png" alt="">   </p>
<h3 id="鏈接的建立："><a href="#鏈接的建立：" class="headerlink" title="鏈接的建立：　　"></a>鏈接的建立：　　</h3><p>刚才说过，TCP 是面向连接的，在传输 TCP 报文段之前先要创建连接，发起连接的一方被称为客户端，而响应连接请求的一方被称为服务端，而这个创建连接的过程被称为 三次握手 ：</p>
<p><img src="https://coding.net/u/sukianata/p/ImgRepository/git/raw/master/TCP%26IP/201807160834.png" alt="">   </p>
<h3 id="鏈接的釋放"><a href="#鏈接的釋放" class="headerlink" title="鏈接的釋放"></a>鏈接的釋放</h3><p><img src="https://coding.net/u/sukianata/p/ImgRepository/git/raw/master/TCP%26IP/201807160848.png" alt="">   </p>
<p>由于TCP连接时全双工的，因此，每个方向都必须要单独进行关闭，这一原则是当一方完成数据发送任务后，发送一个FIN来终止这一方向的连接，收到一个FIN只是意味着这一方向上没有数据流动了，即不会再收到数据了，但是在这个TCP连接上仍然能够发送数据，直到这一方向也发送了FIN。首先进行关闭的一方将执行主动关闭，而另一方则执行被动关闭，上图描述的即是如此。</p>
<p>（1）第一次挥手：Client发送一个FIN，用来关闭Client到Server的数据传送，Client进入FIN_WAIT_1状态。</p>
<p>（2）第二次挥手：Server收到FIN后，发送一个ACK给Client，确认序号为收到序号+1（与SYN相同，一个FIN占用一个序号），Server进入CLOSE_WAIT状态。</p>
<p>（3）第三次挥手：Server发送一个FIN，用来关闭Server到Client的数据传送，Server进入LAST_ACK状态。</p>
<p>（4）第四次挥手：Client收到FIN后，Client进入TIME_WAIT状态，接着发送一个ACK给Server，确认序号为收到序号+1，Server进入CLOSED状态，完成四次挥手。</p>
<p>Client對Server說：我要關門了。</p>
<p>Server對Client說: 好，你關吧。</p>
<p>Server對Client說: 哦，對了，我也要關門了。  </p>
<p>Client對Server說: 好的。  </p>
<h3 id="為什麼建立鏈接時三次握手，關閉鏈接是四次握手？"><a href="#為什麼建立鏈接時三次握手，關閉鏈接是四次握手？" class="headerlink" title="為什麼建立鏈接時三次握手，關閉鏈接是四次握手？"></a>為什麼建立鏈接時三次握手，關閉鏈接是四次握手？</h3><p>这是因为服务端在LISTEN状态下，收到建立连接请求的SYN报文后，把ACK和SYN放在一个报文里发送给客户端。而关闭连接时，当收到对方的FIN报文时，仅仅表示对方不再发送数据了但是还能接收数据，己方也未必全部数据都发送给对方了，所以己方可以立即close，也可以发送一些数据给对方后，再发送FIN报文给对方来表示同意现在关闭连接，因此，己方ACK和FIN一般都会分开发送</p>
<h3 id="TCP可靠傳輸的實現"><a href="#TCP可靠傳輸的實現" class="headerlink" title="TCP可靠傳輸的實現"></a>TCP可靠傳輸的實現</h3><p>(1) TCP 报文段的长度可变，根据收发双方的缓存状态、网络状态而调整。</p>
<p>(2) 当 TCP 收到发自 TCP 连接另一端的数据，它将发送一个确认。</p>
<p>(3) 当 TCP 发出一个段后，它启动一个定时器，等待目的端确认收到这个报文段，如果不能及时收到一个确认，将重发这个报文段。这就是稍后介绍的超时重传。</p>
<p>(4) TCP 将保持它首部和数据的检验和。如果通过检验和发现报文段有差错，这个报文段将被丢弃，等待超时重传。</p>
<p>(5) TCP 将数据按字节排序，报文段中有序号，以确保顺序的正确性。</p>
<p>(6) TCP 还能提供流量控制。TCP 连接的每一方都有收发缓存。TCP 的接收端只允许另一端发送接收端缓冲区所能接纳的数据。这将防止较快主机致使较慢主机的缓冲区溢出。</p>
<p>可见超时重发机制是 TCP 可靠性的关键，只要没有得到确认报文段，就重新发送数据报，直到收到对方的确认为止。  </p>
<p>###　超時重傳　　<br>TCP 规定，接收者收到数据报文段后，需回复一个确认报文段，以告知发送者数据已经收到。而发送者如果一段时间内(超时计时器)没有收到确认报文段，便重复发送：　　</p>
<p><img src="https://coding.net/u/sukianata/p/ImgRepository/git/raw/master/TCP%26IP/201807160858.png" alt="">     </p>
<p>为了实现超时间重传，需要注意：</p>
<p>1.发送者发送一个报文段后，暂时保存该报文段的副本，为发生超时重传时使用，收到确认报文后删除该报文段。</p>
<p>2.确认报文段也需要序号，才能明确是发出去的那个数据报得到了确认。</p>
<p>3.超时计时器比传输往返时间略长，但具体值是不确定的，根据网络情况而变。</p>
<h3 id="連續ARQ協議"><a href="#連續ARQ協議" class="headerlink" title="連續ARQ協議"></a>連續ARQ協議</h3><p>也许你也发现了，按上面的介绍，超时重传机制很费时间，每发送一个数据报都要等待确认。</p>
<p>在实际应用中的确不是这样的，真实情况是，采用了流水线传输：发送方可以连续发送多个报文段(连续发送的数据长度叫做窗口)，而不必每发完一段就停下来等待确认。</p>
<p>实际应用中，接收方也不必对收到的每个报文都做回复，而是采用累积确认方式：接收者收到多个连续的报文段后，只回复确认最后一个报文段，表示在这之前的数据都已收到。</p>
<p>这样，传输效率得到了很大的提升。  </p>
<p><img src="https://coding.net/u/sukianata/p/ImgRepository/git/raw/master/TCP%26IP/201807160901.png" alt="">    </p>
<h3 id="流量控制和擁塞控制"><a href="#流量控制和擁塞控制" class="headerlink" title="流量控制和擁塞控制"></a>流量控制和擁塞控制</h3><p>由于接收方缓存的限制，发送窗口不能大于接收方接收窗口。在报文段首部有一个字段就叫做窗口(rwnd)，这便是用于告诉对方自己的接收窗口，可见窗口的大小是可以变化的。</p>
<p>那么窗口的大小是如何变化的呢？TCP 对于拥塞的控制总结为“慢启动、加性增、乘性减”，如图所示：</p>
<p><img src="https://coding.net/u/sukianata/p/ImgRepository/git/raw/master/TCP%26IP/201807160903.png" alt=""><br>(1) 慢启动 ：初始的窗口值很小，但是按指数规律渐渐增长，直到达到慢开始门限(ssthresh)。</p>
<p>(2) 加性增 ：窗口值达到慢开始门限后，每发送一个报文段，窗口值增加一个单位量。</p>
<p>(3) 乘性减 ：无论什么阶段，只要出现超时，则把窗口值减小一半。  </p>
<h2 id="應用層協議"><a href="#應用層協議" class="headerlink" title="應用層協議"></a>應用層協議</h2><h3 id="DNS協議"><a href="#DNS協議" class="headerlink" title="DNS協議"></a>DNS協議</h3><p>DNS (Domain Name Service 域名服务) 协议基于 UDP，使用端口号 53。</p>
<p>由数字组成的 IP 地址很难记忆，所以我们上网使用网站 IP 地址的别名——域名。实际使用中，域名与 IP 地址是对应的，这种对应关系保存在DNS 服务器之中。</p>
<p>在浏览器中输入一个域名后，会有 DNS 服务器将域名解析为对应的 IP 地址。注意这和网络层的 ARP 协议的不同之处：DNS 提供的是域名与 IP 地址的对应关系，而 ARP 提供的是 IP 地址和 MAC 地址的对应关系。  </p>
<p><strong>DNS 服务器</strong></p>
<p>DNS 服务器是个分层次的系统：</p>
<p>(1)根 DNS 服务器 ：全世界共有 13 台根域名服务器，编号 A 到 M，其中大部分位于美国。</p>
<p>(2)顶级(TLD)DNS 服务器 ：负责如 com 、org 、edu 等顶级域名和所有国家的顶级域名(如 cn 、uk 、jp )。</p>
<p>(3)权威 DNS 服务器 ：大型组织、大学、企业的域名解析服务。</p>
<p>(4)本地 DNS 服务器 ：通常与我们主机最近的 DNS 服务器。</p>
<p>而域名解析的过程，有迭代查询和递归查询两种方式：  </p>
<p>  <img src="https://coding.net/u/sukianata/p/ImgRepository/git/raw/master/TCP%26IP/201807160914.png" alt=""></p>
<p>###　FTP協議<br>FTP (File Transfer Protocol 文件传输协议) 基于 TCP，使用端口号 20(数据)和 21(控制)。</p>
<p>它的主要功能是减少或消除在不同操作系统下处理文件的不兼容性，以达到便捷高效的文件传输效果。</p>
<ul>
<li><p>FTP 只提供文件传输的基本服务，它采用 客户端—服务器 的方式，一个 FTP 服务器可同时为多个客户端提供服务。</p>
</li>
<li><p>在进行文件传输时，FTP 的客户端和服务器之间会建立两个 TCP 连接：21 号端口建立控制连接，20 号端口建立数据连接。</p>
</li>
<li><p>FTP 的传输有两种方式：ASCII 传输模式和二进制数据传输模式。  </p>
</li>
</ul>
<h3 id="HTTP協議"><a href="#HTTP協議" class="headerlink" title="HTTP協議"></a>HTTP協議</h3><p>HTTP (HyperText Transfer Protocol 超文本传输协议) 基于 TCP，使用端口号 80 或 8080。</p>
<p>每当你在浏览器里输入一个网址或点击一个链接时，浏览器就通过 HTTP 协议将网页信息从服务器提取再显示出来，这是现在使用频率最大的应用层协议。</p>
<p>这个原理很简单：</p>
<p>点击一个链接后，浏览器向服务器发起 TCP 连接；</p>
<p>连接建立后浏览器发送 HTTP 请求报文，然后服务器回复响应报文；</p>
<p>浏览器将收到的响应报文内容显示在网页上；</p>
<p>报文收发结束，关闭 TCP 连接。</p>
<p>HTTP 报文会被传输层封装为 TCP 报文段，然后再被 IP 层封装为 IP 数据报。HTTP 报文的结构 ：  </p>
<p>  <img src="https://coding.net/u/sukianata/p/ImgRepository/git/raw/master/TCP%26IP/201807160917.png" alt=""></p>
<blockquote>
<p><strong>資料來源：<a href="www.shiyanlou.com">www.shiyanlou.com</a></strong></p>
</blockquote>

      
    </div>

    

    
    
    

    

    
      <div>
        <div style="padding: 10px 0; margin: 20px auto; width: 90%; text-align: center;">
  <div></div>
  <button id="rewardButton" disable="enable" onclick="var qr = document.getElementById('QR'); if (qr.style.display === 'none') {qr.style.display='block';} else {qr.style.display='none'}">
    <span>赏</span>
  </button>
  <div id="QR" style="display: none;">

    
      <div id="wechat" style="display: inline-block">
        <img id="wechat_qr" src="/images/wechatpay.jpg" alt="HuangFan 微信支付"/>
        <p>微信支付</p>
      </div>
    

    

    

  </div>
</div>

      </div>
    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/TCP-IP/" rel="tag"># TCP/IP</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2018/07/09/LinOTP服務的搭建與應用/" rel="next" title="LinOTP服務的搭建與應用">
                <i class="fa fa-chevron-left"></i> LinOTP服務的搭建與應用
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2018/07/18/RPC調用webservice/" rel="prev" title="RPC調用webservice">
                RPC調用webservice <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          

  
    <div class="comments" id="comments">
      <div id="lv-container" data-id="city" data-uid="MTAyMC8zNjgwNy8xMzM0Mw=="></div>
    </div>

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            Overview
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">HuangFan</p>
              <p class="site-description motion-element" itemprop="description">Java</p>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">11</span>
                    <span class="site-state-item-name">posts</span>
                  </a>
                </div>
              

              

              
                
                
                <div class="site-state-item site-state-tags">
                  <a href="/Tags/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">8</span>
                    <span class="site-state-item-name">tags</span>
                  </a>
                </div>
              
            </nav>
          

          

          
            <div class="links-of-author motion-element">
              
                <span class="links-of-author-item">
                  <a href="https://www.zhihu.com/people/man-tou-hao-chi-bu/activities" target="_blank" title="知乎" rel="external nofollow"><i class="fa fa-fw fa-globe"></i>知乎</a>
                  
                </span>
              
            </div>
          

          
          

          
          

          
            
          
          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#TCP-IP簡介"><span class="nav-number">1.</span> <span class="nav-text">TCP/IP簡介</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#OSI七層模型"><span class="nav-number">1.1.</span> <span class="nav-text">OSI七層模型</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#封裝和分用"><span class="nav-number">1.2.</span> <span class="nav-text">封裝和分用</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#鏈路層介紹"><span class="nav-number">2.</span> <span class="nav-text">鏈路層介紹</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#簡介"><span class="nav-number">2.1.</span> <span class="nav-text">簡介</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#控制幀的傳輸"><span class="nav-number">2.2.</span> <span class="nav-text">控制幀的傳輸</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#差錯控制"><span class="nav-number">2.2.1.</span> <span class="nav-text">差錯控制</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#流量控制"><span class="nav-number">2.2.2.</span> <span class="nav-text">流量控制</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#以太網"><span class="nav-number">2.3.</span> <span class="nav-text">以太網</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#PPP-點對點協議"><span class="nav-number">2.4.</span> <span class="nav-text">PPP(點對點協議)</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#IP網際協議"><span class="nav-number">3.</span> <span class="nav-text">IP網際協議</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#IP數據報"><span class="nav-number">3.1.</span> <span class="nav-text">IP數據報</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#IP地址分類"><span class="nav-number">3.2.</span> <span class="nav-text">IP地址分類</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#子網劃分"><span class="nav-number">3.3.</span> <span class="nav-text">子網劃分</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#IP路由選擇"><span class="nav-number">3.4.</span> <span class="nav-text">IP路由選擇</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#NAT技術"><span class="nav-number">3.5.</span> <span class="nav-text">NAT技術</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#IP的未來"><span class="nav-number">3.6.</span> <span class="nav-text">IP的未來</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#網絡層其它協議"><span class="nav-number">4.</span> <span class="nav-text">網絡層其它協議</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#傳輸層：UDP協議"><span class="nav-number">5.</span> <span class="nav-text">傳輸層：UDP協議</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#傳輸層協議"><span class="nav-number">5.1.</span> <span class="nav-text">傳輸層協議</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#端口"><span class="nav-number">5.2.</span> <span class="nav-text">端口</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#UDP概述"><span class="nav-number">5.3.</span> <span class="nav-text">UDP概述</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#UDP報文"><span class="nav-number">5.4.</span> <span class="nav-text">UDP報文</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#傳輸層：TCP協議"><span class="nav-number">6.</span> <span class="nav-text">傳輸層：TCP協議</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#概述"><span class="nav-number">6.1.</span> <span class="nav-text">概述</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#TCP報文字段結構"><span class="nav-number">6.2.</span> <span class="nav-text">TCP報文字段結構</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#鏈接的建立："><span class="nav-number">6.3.</span> <span class="nav-text">鏈接的建立：　　</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#鏈接的釋放"><span class="nav-number">6.4.</span> <span class="nav-text">鏈接的釋放</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#為什麼建立鏈接時三次握手，關閉鏈接是四次握手？"><span class="nav-number">6.5.</span> <span class="nav-text">為什麼建立鏈接時三次握手，關閉鏈接是四次握手？</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#TCP可靠傳輸的實現"><span class="nav-number">6.6.</span> <span class="nav-text">TCP可靠傳輸的實現</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#連續ARQ協議"><span class="nav-number">6.7.</span> <span class="nav-text">連續ARQ協議</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#流量控制和擁塞控制"><span class="nav-number">6.8.</span> <span class="nav-text">流量控制和擁塞控制</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#應用層協議"><span class="nav-number">7.</span> <span class="nav-text">應用層協議</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#DNS協議"><span class="nav-number">7.1.</span> <span class="nav-text">DNS協議</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#HTTP協議"><span class="nav-number">7.2.</span> <span class="nav-text">HTTP協議</span></a></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">HuangFan</span>

  

  
</div>


  










        
<div class="busuanzi-count">
  <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  

  
</div>









        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
          <span id="scrollpercent"><span>0</span>%</span>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>














  



  
  



  
  



  
  





  



  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script>
  

  
  
    <script type="text/javascript" src="/lib/three/three.min.js"></script>
  

  
  
    <script type="text/javascript" src="/lib/three/three-waves.min.js"></script>
  

  
  
    <script type="text/javascript" src="/lib/three/canvas_lines.min.js"></script>
  

  
  
    <script type="text/javascript" src="/lib/three/canvas_sphere.min.js"></script>
  

  
  
    <script type="text/javascript" src="/lib/reading_progress/reading_progress.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=6.3.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=6.3.0"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=6.3.0"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=6.3.0"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=6.3.0"></script>



  



	





  





  
    <script type="text/javascript">
      (function(d, s) {
        var j, e = d.getElementsByTagName(s)[0];
        if (typeof LivereTower === 'function') { return; }
        j = d.createElement(s);
        j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
        j.async = true;
        e.parentNode.insertBefore(j, e);
      })(document, 'script');
    </script>
  










  





  

  

  

  

  
  

  

  

  

  

  

</body>
<!-- 页面点击小红心 -->
<script type="text/javascript" src="/js/src/love.js"></script>
</html>
